Logging output to terminal_logs/train_comp_20250523_021159.log
Starting a new run with the following parameters:
Namespace(name='mel_fold_0_t', gpu=[0], force_flash_attention=False, compile=['frontend', 'transformer_blocks', 'task_heads'], n_layers=6, transformer_dim=512, frontend_dropout=0.1, transformer_dropout=0.2, lr=0.0008, weight_decay=0.01, logger='wandb', num_workers=10, n_heads=16, fps=50, loss='shift_tolerant_weighted_bce', warmup_steps=1000, max_epochs=100, batch_size=10, accumulate_grad_batches=8, train_length=1500, dbn=False, eval_trim_beats=5, val_frequency=5, tempo_augmentation=True, pitch_augmentation=True, mask_augmentation=True, sum_head=True, partial_transformers=True, length_based_oversampling_factor=0.65, val=True, hung_data=False, fold=0, seed=0, checkpoint_path=None, finetune_lr=None, freeze_frontend=False, freeze_transformer=False, freeze_heads=False, save_logs=True)
data_dir /home/julio.hsu/beat_this/beat_this/data
checkpoint_dir launch_scripts/checkpoints
Skipping tapcorrect/tapcorrect_075 because not all necessary spectrograms are there.
Validation set: 427 items from: frank hainsworth hjdb jaah simac smc tapcorrect
Skipping frank/Schubert_Impromptu_op because not all necessary spectrograms are there.
Skipping hjdb/hjdb_a_musical_box because not all necessary spectrograms are there.
Skipping tapcorrect/tapcorrect_006 because not all necessary spectrograms are there.Skipping tapcorrect/tapcorrect_014 because not all necessary spectrograms are there.
Skipping tapcorrect/tapcorrect_036 because not all necessary spectrograms are there.
Skipping tapcorrect/tapcorrect_034 because not all necessary spectrograms are there.Skipping tapcorrect/tapcorrect_021 because not all necessary spectrograms are there.Skipping tapcorrect/tapcorrect_045 because not all necessary spectrograms are there.Skipping tapcorrect/tapcorrect_055 because not all necessary spectrograms are there.Skipping tapcorrect/tapcorrect_041 because not all necessary spectrograms are there.
Skipping tapcorrect/tapcorrect_061 because not all necessary spectrograms are there.
Skipping tapcorrect/tapcorrect_051 because not all necessary spectrograms are there.

Skipping tapcorrect/tapcorrect_080 because not all necessary spectrograms are there.Skipping tapcorrect/tapcorrect_083 because not all necessary spectrograms are there.


Skipping tapcorrect/tapcorrect_081 because not all necessary spectrograms are there.
Skipping tapcorrect/tapcorrect_094 because not all necessary spectrograms are there.
Skipping tapcorrect/tapcorrect_052 because not all necessary spectrograms are there.Skipping tapcorrect/tapcorrect_102 because not all necessary spectrograms are there.

Skipping tapcorrect/tapcorrect_090 because not all necessary spectrograms are there.
Skipping tapcorrect/tapcorrect_088 because not all necessary spectrograms are there.


Skipping tapcorrect/tapcorrect_087 because not all necessary spectrograms are there.

Training set oversampled from 2983 to 7645 excerpts.
Training set: 7645 items from: frank hainsworth hjdb jaah simac smc tapcorrect
Using positive weights:  {'beat': 20, 'downbeat': 97}
Total parameters: 20251712
Trainable parameters: 20251696 (100.00%)
Will compile model frontend
Will compile model transformer_blocks
Will compile model task_heads
wandb: Currently logged in as: joaquimbr (juliohsu) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in ./wandb/run-20250523_021207-7vj2efa0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run mel_fold_0_t fold0 shift_tolerant_weighted_bce-h512-augTrueTrueTrue
wandb:  View project at https://wandb.ai/juliohsu/beat_this
wandb:  View run at https://wandb.ai/juliohsu/beat_this/runs/7vj2efa0
Test set: 999 items from: gtzan
Testing: |          | 0/? [00:00<?, ?it/s]Testing:   0%|          | 0/999 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/999 [00:00<?, ?it/s]/home/your_email/miniconda3/envs/beattune_py310/lib/python3.10/site-packages/mir_eval/beat.py:93: UserWarning: Estimated beats are empty.
  warnings.warn("Estimated beats are empty.")
Testing DataLoader 0:   0%|          | 1/999 [00:58<16:16:55,  0.02it/s]Testing DataLoader 0:   0%|          | 2/999 [00:58<8:08:45,  0.03it/s] Testing DataLoader 0:   0%|          | 3/999 [00:58<5:26:01,  0.05it/s]Testing DataLoader 0:   0%|          | 4/999 [00:58<4:04:33,  0.07it/s]Testing DataLoader 0:   1%|          | 5/999 [00:59<3:15:43,  0.08it/s]Testing DataLoader 0:   1%|          | 6/999 [00:59<2:43:08,  0.10it/s]Testing DataLoader 0:   1%|          | 7/999 [00:59<2:19:51,  0.12it/s]Testing DataLoader 0:   1%|          | 8/999 [00:59<2:02:24,  0.13it/s]Testing DataLoader 0:   1%|          | 9/999 [00:59<1:48:52,  0.15it/s]Testing DataLoader 0:   1%|1         | 10/999 [00:59<1:38:00,  0.17it/s]Testing DataLoader 0:   1%|1         | 11/999 [00:59<1:29:06,  0.18it/s]Testing DataLoader 0:   1%|1         | 12/999 [00:59<1:21:41,  0.20it/s]Testing DataLoader 0:   1%|1         | 13/999 [00:59<1:15:26,  0.22it/s]Testing DataLoader 0:   1%|1         | 14/999 [00:59<1:10:03,  0.23it/s]Testing DataLoader 0:   2%|1         | 15/999 [00:59<1:05:24,  0.25it/s]Testing DataLoader 0:   2%|1         | 16/999 [00:59<1:01:19,  0.27it/s]Testing DataLoader 0:   2%|1         | 17/999 [00:59<57:44,  0.28it/s]  Testing DataLoader 0:   2%|1         | 18/999 [01:00<54:33,  0.30it/s]Testing DataLoader 0:   2%|1         | 19/999 [01:00<51:41,  0.32it/s]Testing DataLoader 0:   2%|2         | 20/999 [01:00<49:07,  0.33it/s]Testing DataLoader 0:   2%|2         | 21/999 [01:00<46:48,  0.35it/s]Testing DataLoader 0:   2%|2         | 22/999 [01:00<44:41,  0.36it/s]Testing DataLoader 0:   2%|2         | 23/999 [01:00<42:45,  0.38it/s]Testing DataLoader 0:   2%|2         | 24/999 [01:00<40:59,  0.40it/s]Testing DataLoader 0:   3%|2         | 25/999 [01:00<39:22,  0.41it/s]Testing DataLoader 0:   3%|2         | 26/999 [01:00<37:51,  0.43it/s]Testing DataLoader 0:   3%|2         | 27/999 [01:00<36:27,  0.44it/s]Testing DataLoader 0:   3%|2         | 28/999 [01:00<35:10,  0.46it/s]Testing DataLoader 0:   3%|2         | 29/999 [01:00<33:58,  0.48it/s]Testing DataLoader 0:   3%|3         | 30/999 [01:01<32:51,  0.49it/s]Testing DataLoader 0:   3%|3         | 31/999 [01:01<31:48,  0.51it/s]Testing DataLoader 0:   3%|3         | 32/999 [01:01<30:49,  0.52it/s]Testing DataLoader 0:   3%|3         | 33/999 [01:01<29:53,  0.54it/s]Testing DataLoader 0:   3%|3         | 34/999 [01:01<29:01,  0.55it/s]Testing DataLoader 0:   4%|3         | 35/999 [01:01<28:12,  0.57it/s]Testing DataLoader 0:   4%|3         | 36/999 [01:01<27:25,  0.59it/s]Testing DataLoader 0:   4%|3         | 37/999 [01:01<26:41,  0.60it/s]Testing DataLoader 0:   4%|3         | 38/999 [01:01<25:59,  0.62it/s]Testing DataLoader 0:   4%|3         | 39/999 [01:01<25:20,  0.63it/s]Testing DataLoader 0:   4%|4         | 40/999 [01:01<24:42,  0.65it/s]Testing DataLoader 0:   4%|4         | 41/999 [01:01<24:07,  0.66it/s]Testing DataLoader 0:   4%|4         | 42/999 [01:02<23:33,  0.68it/s]Testing DataLoader 0:   4%|4         | 43/999 [01:02<23:00,  0.69it/s]Testing DataLoader 0:   4%|4         | 44/999 [01:02<22:29,  0.71it/s]Testing DataLoader 0:   5%|4         | 45/999 [01:02<22:00,  0.72it/s]Testing DataLoader 0:   5%|4         | 46/999 [01:02<21:32,  0.74it/s]Testing DataLoader 0:   5%|4         | 47/999 [01:02<21:05,  0.75it/s]Testing DataLoader 0:   5%|4         | 48/999 [01:02<20:39,  0.77it/s]Testing DataLoader 0:   5%|4         | 49/999 [01:02<20:14,  0.78it/s]Testing DataLoader 0:   5%|5         | 50/999 [01:02<19:50,  0.80it/s]Testing DataLoader 0:   5%|5         | 51/999 [01:02<19:27,  0.81it/s]Testing DataLoader 0:   5%|5         | 52/999 [01:02<19:05,  0.83it/s]Testing DataLoader 0:   5%|5         | 53/999 [01:02<18:44,  0.84it/s]Testing DataLoader 0:   5%|5         | 54/999 [01:03<18:23,  0.86it/s]Testing DataLoader 0:   6%|5         | 55/999 [01:03<18:03,  0.87it/s]Testing DataLoader 0:   6%|5         | 56/999 [01:03<17:44,  0.89it/s]Testing DataLoader 0:   6%|5         | 57/999 [01:03<17:26,  0.90it/s]Testing DataLoader 0:   6%|5         | 58/999 [01:03<17:08,  0.91it/s]Testing DataLoader 0:   6%|5         | 59/999 [01:03<16:51,  0.93it/s]Testing DataLoader 0:   6%|6         | 60/999 [01:03<16:34,  0.94it/s]Testing DataLoader 0:   6%|6         | 61/999 [01:03<16:18,  0.96it/s]Testing DataLoader 0:   6%|6         | 62/999 [01:03<16:03,  0.97it/s]Testing DataLoader 0:   6%|6         | 63/999 [01:03<15:48,  0.99it/s]Testing DataLoader 0:   6%|6         | 64/999 [01:03<15:33,  1.00it/s]Testing DataLoader 0:   7%|6         | 65/999 [01:03<15:19,  1.02it/s]Testing DataLoader 0:   7%|6         | 66/999 [01:04<15:05,  1.03it/s]Testing DataLoader 0:   7%|6         | 67/999 [01:04<14:52,  1.04it/s]Testing DataLoader 0:   7%|6         | 68/999 [01:04<14:39,  1.06it/s]Testing DataLoader 0:   7%|6         | 69/999 [01:04<14:27,  1.07it/s]Testing DataLoader 0:   7%|7         | 70/999 [01:04<14:15,  1.09it/s]Testing DataLoader 0:   7%|7         | 71/999 [01:04<14:03,  1.10it/s]Testing DataLoader 0:   7%|7         | 72/999 [01:04<13:51,  1.11it/s]Testing DataLoader 0:   7%|7         | 73/999 [01:04<13:40,  1.13it/s]Testing DataLoader 0:   7%|7         | 74/999 [01:04<13:29,  1.14it/s]Testing DataLoader 0:   8%|7         | 75/999 [01:04<13:18,  1.16it/s]Testing DataLoader 0:   8%|7         | 76/999 [01:04<13:08,  1.17it/s]Testing DataLoader 0:   8%|7         | 77/999 [01:04<12:58,  1.18it/s]Testing DataLoader 0:   8%|7         | 78/999 [01:05<12:48,  1.20it/s]Testing DataLoader 0:   8%|7         | 79/999 [01:05<12:39,  1.21it/s]Testing DataLoader 0:   8%|8         | 80/999 [01:05<12:29,  1.23it/s]Testing DataLoader 0:   8%|8         | 81/999 [01:05<12:20,  1.24it/s]Testing DataLoader 0:   8%|8         | 82/999 [01:05<12:12,  1.25it/s]Testing DataLoader 0:   8%|8         | 83/999 [01:05<12:03,  1.27it/s]Testing DataLoader 0:   8%|8         | 84/999 [01:05<11:55,  1.28it/s]Testing DataLoader 0:   8%|8         | 84/999 [01:06<12:07,  1.26it/s]
